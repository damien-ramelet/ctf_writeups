import datetime
import crypt
from wordslist import wordslist
from ctypes import CDLL

libc = CDLL("libc.so.6")

timestamp = datetime.datetime(2024, 6, 28, 21, 42, 42).timestamp() # 21:42:42 UTC+2
libc.srand(int(timestamp))

charset = "0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"
salt_size = 16
token_size = 8
user_hash = "$6$NBYlg3a0nG8eykJg$KnzV/9n5DpRkeNHLcdXfviKsh0Z9NaPQdXg9Pd4nBOXuN6gr3dfAHxo71Y/dCGvG5kei3Y8ganUcz1RqrdTUt/"

salt = ""
token = ""

def generate_random_char_from_charset():
    index = libc.rand()
    return charset[index % 62]

for _ in range(16):
    salt += generate_random_char_from_charset()
salt = "$6$" + salt

for _ in range(8):
    token += generate_random_char_from_charset()

for word in wordslist:
    hash = crypt.crypt(word + token, salt)
    if hash == user_hash:
        print(f"SHLK{{{word + token}}}")
        break
